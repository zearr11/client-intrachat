<!--   aria-hidden="true" aria-labelledby="staticBackdropLabel" -->
<div
  #modalElement
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  class="modal fade"
>
  <div
    class="modal-dialog modal-dialog-centered modal-xxl"
    style="max-width: 95%"
  >
    <div class="modal-content shadow-lg rounded-3 border-0">
      <!-- HEADER -->
      <div class="modal-header border-bottom">
        <h4 class="modal-title">Nuevo Equipo</h4>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>

      <div class="modal-body bg-white">
        <div class="row g-4">
          <!-- OPERACIONES -->
          <div class="col-12 col-md-4">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body p-3">
                <h6 class="fw-bold text-secondary mb-3">
                  Selecciona una operación
                </h6>

                <input
                  #txtOperation
                  type="text"
                  class="form-control form-control-sm mb-3"
                  placeholder="Buscar operación..."
                  (input)="filterOperation(txtOperation.value)"
                />

                <div
                  class="list-container"
                  (scroll)="onScrollOperations($event)"
                >
                  @for (op of operations(); track op.id) {
                  <div
                    class="d-flex align-items-center py-2 border-bottom small hover-row"
                  >
                    <input
                      #operationSelected
                      type="checkbox"
                      class="form-check-input me-2 mt-0"
                      [checked]="op.isSelected"
                      (change)="selectOperation(op, operationSelected.checked)"
                    />
                    <span>{{ op.descripcion }}</span>
                  </div>
                  }
                </div>
              </div>
            </div>
          </div>

          <!-- SUPERVISORES -->
          <div class="col-12 col-md-4">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body p-3">
                <h6 class="fw-bold text-secondary mb-3">
                  Selecciona el supervisor
                </h6>

                <input
                  #txtSupervisor
                  type="text"
                  class="form-control form-control-sm mb-3"
                  placeholder="Buscar supervisor..."
                  (input)="filterSupervisor(txtSupervisor.value)"
                />

                <div
                  class="list-container"
                  (scroll)="onScrollSupervisors($event)"
                >
                  @for (sup of supervisors(); track sup.id) {
                  <div
                    class="d-flex align-items-center py-2 border-bottom small hover-row"
                  >
                    <input
                      #supervisorSelected
                      type="checkbox"
                      class="form-check-input me-2 mt-0"
                      [checked]="sup.isSelected"
                      (change)="
                        selectSupervisor(sup, supervisorSelected.checked)
                      "
                    />
                    <span>{{ sup.descripcion }}</span>
                  </div>
                  }
                </div>
              </div>
            </div>
          </div>

          <!-- MIEMBROS -->
          <div class="col-12 col-md-4">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body p-3">
                <h6 class="fw-bold text-secondary mb-3">
                  Selecciona los integrantes
                </h6>

                <input
                  #txtMember
                  type="text"
                  class="form-control form-control-sm mb-3"
                  placeholder="Buscar miembro..."
                  (input)="filterMembers(txtMember.value)"
                />

                <div class="list-container" (scroll)="onScrollMembers($event)">
                  @for (mem of members(); track mem.id) {

                  <div
                    class="d-flex align-items-center py-2 border-bottom small hover-row"
                  >
                    <input
                      #memberSelected
                      type="checkbox"
                      class="form-check-input me-2 mt-0"
                      [checked]="mem.isSelected"
                      (click)="selectMember(mem)"
                    />

                    <span class="me-2 flex-grow-1">{{ mem.descripcion }}</span>

                    <select
                      class="form-select form-select-sm w-auto ms-auto"
                      [ngModel]="mem.permission"
                      (ngModelChange)="changePermissionMember(mem, $event)"
                    >
                      @for (p of permissions; track $index) {
                      <option [ngValue]="p">
                        {{ p | removeunderscore }}
                      </option>
                      }
                    </select>
                  </div>

                  }
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- FOOTER -->
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-danger"
          data-bs-dismiss="modal"
        >
          Cerrar
        </button>
        <button
          type="button"
          class="btn btn-success px-4"
          (click)="registerTeam()"
        >
          Registrar Equipo
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  .list-container {
    height: 380px;
    overflow-y: auto;
    border-radius: 6px;
    border: 1px solid #e3e3e3;
    padding: 6px;
  }

  /* Scroll fino */
  .list-container::-webkit-scrollbar {
    width: 6px;
  }

  .list-container::-webkit-scrollbar-thumb {
    background: #c7c7c7;
    border-radius: 4px;
  }

  /* Hover en filas */
  .hover-row:hover {
    background: #f5f5f5;
    cursor: pointer;
  }
</style>
